---
title: "DA4"
output: pdf_document
date: "2025-06-22"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

ISLR Ch 4 Lab
4.6.1 The Stock Market Data
```{r}
library(ISLR)
library(ggplot2)
?Smarket
names(Smarket)
```
```{r}
model1 = Smarket
dim(Smarket)
```

this data set has 1250 rows and 9 columns 
```{r}
summary(Smarket)
```
```{r}
cor(Smarket[,-9]) 
```
we make -9 because the direction column consists text. 
The correlations between today's returns and previous days' returns (lag1-5) are really close to zero, so there's no relationship between previous returns and today's. 
The only significant correlation is between volume and year (0.539), so let's plot it 

```{r}
plot(Smarket$Year, Smarket$Volume)
```
```{r}
ggplot(data = model1) + 
  geom_point(mapping = aes(x = Volume, y = Year, color = Direction))
```
through this graphs we can see that volume is increasing as time passes by

4.6.2 Logistic Regression
```{r}
attach(Smarket)
glm.fit = glm(Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + Volume, data = Smarket, family=binomial)
summary(glm.fit)
```
the lowest p value is for lag1 (0.145), but it is still >0.05, so we fail to reject the null hypothesis. We can't claim that there is a real relationship 

```{r}
coef(glm.fit) 
```

if we have an equation like y=a + b1x1 + b2x2 + ... 
those coefficients are actually those b1, b2 values. Intercept is the a. But in order to see whether we can trust that, we need to have p value. 
 here y=1 corresponds to “Up” and Y=0 to “Down”

```{r}
summary (glm.fit)$coef
```
none of the variables' p values are small enough to say that these coefficients are accurate. 

```{r}
probs = predict(glm.fit, type="response")
probs[1:15]
```
this predicts the possibility that the market will go "up". Because it's type is "response"
